<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Transitions for an individual-level continuous time state transition model — IndivCtstmTrans • hesim</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Transitions for an individual-level continuous time state transition model — IndivCtstmTrans" />

<meta property="og:description" content="Summarize health state transitions in an individual-level continuous time state transition model with parameters that were estimated using a multi-state model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hesim</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/psm.html">Partitioned survival models</a>
    </li>
    <li>
      <a href="../articles/icea.html">Individualized cost-effectiveness analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/InnovationValueInitiative/hesim">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transitions for an individual-level continuous time state transition model</h1>
    
    <div class="hidden name"><code>IndivCtstmTrans.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Summarize health state transitions in an individual-level continuous time state transition model with parameters that were estimated using a multi-state model.</p>
    
    </div>

    <pre class="usage"><span class='no'>IndivCtstmTrans</span></pre>
        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code>R6Class</code> object.</p>
    
    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    
    <dl class='dl-horizontal'>
<dt><code>data</code></dt><dd><p>Data used to simulate health state transitions by treatment strategy and patient. Must be 
  an object of class <code><a href='input_data.html'>input_data</a></code>. If <code>params</code> is a list of models, then <code>data</code> must contain a unique row for each treatment strategy and patient; if <code>params</code> is a joint model, then <code>data</code> must contain a unique row for each treatment strategy, patient, and transition.</p></dd>
    <dt><code>params</code></dt><dd><p>An object of class <code><a href='params_surv.html'>params_surv</a></code> or <code><a href='params_surv_list.html'>params_surv_list</a></code>.</p></dd>
    <dt><code>trans_mat</code></dt><dd><p>A transition matrix describing the states and transitions in a multi-state model in the format from the <a href='http://www.rdocumentation.org/packages/mstate/topics/mstate-package'>mstate</a> package. See the documentation for the argument "trans" in <a href='http://www.rdocumentation.org/packages/mstate/topics/msprep'>msprep</a>.</p></dd>
    <dt><code>start_state</code></dt><dd><p>The vectorized (see "Details") starting health state. Default is the first health state.</p></dd>
    <dt><code>start_time</code></dt><dd><p>The vectorized (see "Details")  time at which to begin the simulation. Default is time 0.</p></dd>
    <dt><code>start_age</code></dt><dd><p>The vectorized (see "Details") starting age of each patient in the simulation. Default is 38.</p></dd>
    <dt><code>death_state</code></dt><dd><p>The death state in <code>trans_mat</code>. Used with <code>max_age</code> in <code>sim_disease</code> as patients transition to this state upon reaching maximum age. By default, it is set to the final absorbing state (i.e., a row in <code>trans_mat</code> with all NAs).</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
    <dl class='dl-horizontal'>
    <dt><code>new(data, params, trans_mat, start_state = 1, start_time = 0,
                start_age = 38, death_state = NULL)</code></dt><dd><p>Constructor for the class.</p></dd>
    <dt><code><a href='http://www.rdocumentation.org/packages/flexsurv/topics/hazard'>hazard(t)</a></code></dt><dd><p>Predict the hazard functions for each health state transition.
    <ul>
<li><p><code>t</code>: A numeric vector of times.</p></li>
</ul></p></dd>
    <dt><code>cumhazard(t)</code></dt><dd><p>Predict the cumulative hazard functions for each health state transition.
    <ul>
<li><p><code>t</code>: A numeric vector of times.</p></li>
</ul></p></dd>,
    <dt><code>sim_disease(max_t = 100, max_age = 100)</code></dt><dd><p>Simulate disease progression.
    <ul>
<li><p><code>max_t</code>: The vectorized (see "Details") maximum number of time periods to simulate the model.</p></li>
<li><p><code>max_age</code>: Maximum age to simulate each patient until. Default is 100.</p></li>
</ul>
    Returns an object of class "indiv_ctstm_disprog". See "Details".</p></dd>,
    <dt><code>sim_stateprobs(disprog = NULL, t, ...)</code></dt><dd><p>Simulate health state probabilities at distinct times.
    <ul>
<li><p><code>disprog</code>: If <code>NULL</code>, then state probabilities are simulated by first simulating disease progression using <code>sim_disease</code>. Otherwise,
     state probabilities are computed using the simulation output from <code>disprog</code>. Must be of class "indiv_ctstm_disprog".</p></li>
<li><p><code>t</code>: A numeric vector of times.</p></li>
<li><p><code>...</code>: Additional arguments to pass to <code>sim_disease</code> when <code>disprog = NULL</code>.</p></li>
</ul>
    Returns a <code><a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></code> with the following columns:
    <dl class='dl-horizontal'>
    <dt>sample</dt><dd><p>A random sample from the PSA.</p></dd>
    <dt>strategy_id</dt><dd><p>The treatment strategy ID.</p></dd>
    <dt>state_id</dt><dd><p>The health state ID.</p></dd>
    <dt>t</dt><dd><p>The time at which a state probability is computed.</p></dd>
    <dt>prob</dt><dd><p>The probability of being in a given health state.</p></dd>
    </dl></p></dd>
    <dt><code><a href='check.html'>check()</a></code></dt><dd><p>Input validation for class. Checks that fields are the correct type.</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>An object of class "indiv_ctstm_disprog" is a list containing the following elements:</p><dl class='dl-horizontal'>
<dt>sim</dt><dd><p>A <code><a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></code> of simulated trajectories through a multi-state model.</p></dd>
<dt>n_samples</dt><dd><p>The number of random samples of the parameters used in the probabilistic sensitivity analysis.</p></dd>
<dt>n_states</dt><dd><p>The number of health states in the model.</p></dd>
<dt>unique_strategy_id</dt><dd><p>The ID's of the simulated treatment strategies.</p></dd>
<dt>unique_patient_id</dt><dd><p>The ID's of the simulated patients.</p></dd>
</dl>
    <p>The <code><a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></code> <code>sim</code> contains the following columns:</p>
<dl class='dl-horizontal'>
<dt>sample</dt><dd><p>A random sample from the PSA.</p></dd>
<dt>strategy_id</dt><dd><p>The treatment strategy ID.</p></dd>
<dt>patient_id</dt><dd><p>The patient ID.</p></dd>
<dt>from</dt><dd><p>The health state ID transitioned from.</p></dd>
<dt>to</dt><dd><p>The health state ID transitioned to.</p></dd>
<dt>final</dt><dd><p>An indicator equal to 1 if a patient is in their final health state during the simulation and 0 otherwise.</p></dd>
<dt>time_start</dt><dd><p>The time at the start of the interval.</p></dd>
<dt>time_stop</dt><dd><p>The time at the end of the interval.</p></dd>
</dl>
    <p>The fields <code>start_state</code>, <code>start_time</code>, <code>start_age</code>, and the argument <code>max_t</code> in <code>sim_disease</code> are vectorized across patients, treatment strategies, and random samples of the parameters. Each argument can be passed in three ways:</p>
<ul>
<li><p>As a scalar, implying that values are constant across patients, treatment strategies, and samples.</p></li>
<li><p>As a vector of length equal to the number of patients, implying that values vary across patients but are constant across treatment strategies and samples.</p></li>
<li><p>As a vector of length equal to the product of the number of patients, treatment strategies, and samples. In this case the order should be sorted by sample, treatment strategy, and patient (as with an object of class "indiv_ctstm_disprog"). This option can be used to combine results from multiple simulations using <code>sim_disease</code>. Specifically, values previously simulated can be used as arguments to simulations from a new instance of <code>IndivCtstmTrans</code>.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='create_IndivCtstmTrans.html'>create_IndivCtstmTrans</a></code>, <code><a href='IndivCtstm.html'>IndivCtstm</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='st'>"flexsurv"</span>)

<span class='co'># Simulation data</span>
<span class='no'>dt_strategies</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>strategy_id</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>))
<span class='no'>dt_patients</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>patient_id</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>1</span>, <span class='fl'>3</span>),
                          <span class='kw'>age</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>45</span>, <span class='fl'>50</span>, <span class='fl'>60</span>),
                          <span class='kw'>female</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>))

<span class='co'># Multi-state model with transition specific models</span>
<span class='no'>fits</span> <span class='kw'>&lt;-</span> <span class='fu'>vector</span>(<span class='kw'>length</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"list"</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>bosms3</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'>length</span>(<span class='no'>fits</span>)){
  <span class='no'>fits</span><span class='kw'>[[</span><span class='no'>i</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/flexsurv/topics/flexsurvreg'>flexsurvreg</a></span>(<span class='fu'>Surv</span>(<span class='no'>years</span>, <span class='no'>status</span>) ~ <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>[<span class='no'>dat</span>$<span class='no'>trans</span> <span class='kw'>==</span> <span class='no'>i</span>, ],
                           <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"exp"</span>)
}
<span class='no'>fits</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='flexsurvreg_list.html'>flexsurvreg_list</a></span>(<span class='no'>fits</span>)
<span class='no'>tmat</span> <span class='kw'>&lt;-</span> <span class='fu'>rbind</span>(<span class='fu'>c</span>(<span class='fl'>NA</span>, <span class='fl'>1</span>, <span class='fl'>2</span>),
              <span class='fu'>c</span>(<span class='fl'>NA</span>, <span class='fl'>NA</span>, <span class='fl'>3</span>),
              <span class='fu'>c</span>(<span class='fl'>NA</span>, <span class='fl'>NA</span>, <span class='fl'>NA</span>))

<span class='co'># Simulation model</span>
<span class='no'>hesim_dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='hesim_data.html'>hesim_data</a></span>(<span class='kw'>strategies</span> <span class='kw'>=</span> <span class='no'>dt_strategies</span>,
                        <span class='kw'>patients</span> <span class='kw'>=</span> <span class='no'>dt_patients</span>)
<span class='no'>fits_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='expand_hesim_data.html'>expand_hesim_data</a></span>(<span class='no'>hesim_dat</span>)
<span class='no'>transmod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_IndivCtstmTrans.html'>create_IndivCtstmTrans</a></span>(<span class='no'>fits</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>fits_data</span>, <span class='kw'>trans_mat</span> <span class='kw'>=</span> <span class='no'>tmat</span>,
                                    <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                                    <span class='kw'>point_estimate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>head</span>(<span class='no'>transmod</span>$<span class='fu'><a href='http://www.rdocumentation.org/packages/flexsurv/topics/hazard'>hazard</a></span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>)))</div><div class='output co'>#&gt;    trans sample strategy_id patient_id t     hazard
#&gt; 1:     1      1           0          0 1 0.16540081
#&gt; 2:     1      1           0          0 2 0.16540081
#&gt; 3:     1      1           0          0 3 0.16540081
#&gt; 4:     2      1           0          0 1 0.03399796
#&gt; 5:     2      1           0          0 2 0.03399796
#&gt; 6:     2      1           0          0 3 0.03399796</div><div class='input'><span class='fu'>head</span>(<span class='no'>transmod</span>$<span class='fu'>cumhazard</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>)))</div><div class='output co'>#&gt;    trans sample strategy_id patient_id t  cumhazard
#&gt; 1:     1      1           0          0 1 0.16540081
#&gt; 2:     1      1           0          0 2 0.33080162
#&gt; 3:     1      1           0          0 3 0.49620243
#&gt; 4:     2      1           0          0 1 0.03399796
#&gt; 5:     2      1           0          0 2 0.06799591
#&gt; 6:     2      1           0          0 3 0.10199387</div><div class='input'><span class='no'>disprog</span> <span class='kw'>&lt;-</span> <span class='no'>transmod</span>$<span class='fu'>sim_disease</span>()
<span class='fu'>names</span>(<span class='no'>disprog</span>)</div><div class='output co'>#&gt; [1] "sim"                "n_samples"          "n_states"          
#&gt; [4] "unique_strategy_id" "unique_patient_id" </div><div class='input'><span class='fu'>head</span>(<span class='no'>disprog</span>$<span class='no'>sim</span>)</div><div class='output co'>#&gt;    sample strategy_id patient_id from to final time_start  time_stop
#&gt; 1:      1           1          1    1  3     1   0.000000 17.3415801
#&gt; 2:      1           1          2    1  3     1   0.000000  7.8745693
#&gt; 3:      1           1          3    1  2     0   0.000000  7.9038287
#&gt; 4:      1           1          3    2  3     1   7.903829 12.2889028
#&gt; 5:      1           2          1    1  3     1   0.000000  1.2148552
#&gt; 6:      1           2          2    1  2     0   0.000000  0.2155965</div><div class='input'><span class='no'>transmod</span>$<span class='fu'>sim_stateprobs</span>(<span class='kw'>t</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>5</span>, <span class='fl'>10</span>))[<span class='no'>t</span> <span class='kw'>==</span> <span class='fl'>5</span>]</div><div class='output co'>#&gt;     sample strategy_id state_id t      prob
#&gt;  1:      1           1        1 5 0.6666667
#&gt;  2:      1           1        2 5 0.3333333
#&gt;  3:      1           1        3 5 0.0000000
#&gt;  4:      1           2        1 5 0.0000000
#&gt;  5:      1           2        2 5 0.0000000
#&gt;  6:      1           2        3 5 1.0000000
#&gt;  7:      1           3        1 5 0.0000000
#&gt;  8:      1           3        2 5 0.3333333
#&gt;  9:      1           3        3 5 0.6666667
#&gt; 10:      2           1        1 5 0.3333333
#&gt; 11:      2           1        2 5 0.0000000
#&gt; 12:      2           1        3 5 0.6666667
#&gt; 13:      2           2        1 5 0.3333333
#&gt; 14:      2           2        2 5 0.0000000
#&gt; 15:      2           2        3 5 0.6666667
#&gt; 16:      2           3        1 5 0.3333333
#&gt; 17:      2           3        2 5 0.3333333
#&gt; 18:      2           3        3 5 0.3333333</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#fields">Fields</a></li>

      <li><a href="#methods">Methods</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

